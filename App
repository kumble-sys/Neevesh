<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Tracker - Journey to Goal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
    }

    .header {
        background: white;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        margin-bottom: 30px;
    }

    .header h1 {
        color: #667eea;
        margin-bottom: 10px;
    }

    .goal-section {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 30px;
        border-radius: 15px;
        margin-top: 20px;
    }

    .goal-input {
        display: flex;
        gap: 15px;
        align-items: center;
        margin-top: 15px;
        flex-wrap: wrap;
    }

    .goal-input input {
        padding: 12px;
        border-radius: 8px;
        border: none;
        font-size: 16px;
        width: 200px;
    }

    .goal-input button {
        padding: 12px 25px;
        background: white;
        color: #f5576c;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s;
    }

    .goal-input button:hover {
        transform: scale(1.05);
    }

    .journey-bar {
        background: rgba(255,255,255,0.3);
        height: 40px;
        border-radius: 20px;
        margin-top: 20px;
        overflow: hidden;
        position: relative;
    }

    .journey-progress {
        background: white;
        height: 100%;
        border-radius: 20px;
        transition: width 1s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #f5576c;
        min-width: 50px;
    }

    .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
    }

    .stat-card {
        background: rgba(255,255,255,0.2);
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }

    .stat-card h3 {
        font-size: 14px;
        margin-bottom: 5px;
        opacity: 0.9;
    }

    .stat-card p {
        font-size: 24px;
        font-weight: bold;
    }

    .portfolio-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .section {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .section h2 {
        color: #667eea;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
    }

    .section-total {
        font-size: 18px;
        color: #27ae60;
        font-weight: bold;
        margin-bottom: 15px;
    }

    .add-btn {
        background: #667eea;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.3s;
    }

    .add-btn:hover {
        background: #5568d3;
    }

    .item {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 10px;
        border-left: 4px solid #667eea;
    }

    .item-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .item-name {
        font-weight: bold;
        color: #2c3e50;
    }

    .item-value {
        font-size: 18px;
        font-weight: bold;
        color: #27ae60;
    }

    .item-details {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        font-size: 13px;
        color: #666;
        margin-top: 10px;
    }

    .profit-positive {
        color: #27ae60;
    }

    .profit-negative {
        color: #e74c3c;
    }

    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
    }

    .btn-delete {
        background: #e74c3c;
        color: white;
        padding: 5px 10px;
        font-size: 12px;
        margin-top: 10px;
    }

    .refresh-btn {
        background: #3498db;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        margin-right: 5px;
    }

    .loading {
        text-align: center;
        color: #666;
        font-style: italic;
        padding: 20px;
    }

    .last-updated {
        font-size: 11px;
        color: #999;
        text-align: right;
        margin-top: 10px;
    }

    .custom-btn {
        background: #667eea;
        color: white;
        padding: 15px 30px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin: 20px auto;
        display: block;
    }

    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        overflow: auto;
    }

    .modal-content {
        background-color: white;
        margin: 5% auto;
        padding: 30px;
        border-radius: 15px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .modal-header h2 {
        color: #667eea;
        margin: 0;
    }

    .close {
        color: #aaa;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }

    .close:hover {
        color: #000;
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #2c3e50;
    }

    .form-group input, .form-group select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
    }

    .form-actions {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    .btn-save {
        background: #27ae60;
        color: white;
        flex: 1;
    }

    .btn-cancel {
        background: #95a5a6;
        color: white;
        flex: 1;
    }

    @media (max-width: 768px) {
        .portfolio-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Investment Portfolio Tracker</h1>
            <p>Track your journey to financial goals - Started January 2026</p>

```
        <div class="goal-section">
            <h2>üéØ Financial Goal</h2>
            <div class="goal-input">
                <label style="font-weight: bold;">Target Amount:</label>
                <input type="number" id="targetAmount" placeholder="Enter target amount">
                <button onclick="saveTargetAmount()">Set Goal</button>
            </div>
            
            <div class="journey-bar">
                <div class="journey-progress" id="journeyProgress">0%</div>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <h3>Total Saved</h3>
                    <p id="totalSaved">‚Çπ0</p>
                </div>
                <div class="stat-card">
                    <h3>Target Amount</h3>
                    <p id="targetDisplay">‚Çπ0</p>
                </div>
                <div class="stat-card">
                    <h3>Remaining</h3>
                    <p id="remaining">‚Çπ0</p>
                </div>
                <div class="stat-card">
                    <h3>Progress</h3>
                    <p id="progressPercent">0%</p>
                </div>
            </div>
        </div>
    </div>

    <div class="portfolio-grid">
        <!-- Stocks Section -->
        <div class="section">
            <h2>
                üìà Stocks (NSE/BSE)
                <span>
                    <button class="refresh-btn" onclick="refreshStockPrices()">üîÑ Auto</button>
                    <button class="add-btn" onclick="showAddStock()">+ Add</button>
                </span>
            </h2>
            <div class="section-total">Total: <span id="stockTotal">‚Çπ0</span></div>
            <div id="stockList"></div>
            <div class="last-updated" id="stockLastUpdated"></div>
        </div>

        <!-- Mutual Funds Section -->
        <div class="section">
            <h2>
                üìä Mutual Funds
                <span>
                    <button class="refresh-btn" onclick="refreshMFPrices()">üîÑ Auto</button>
                    <button class="add-btn" onclick="showAddMF()">+ Add</button>
                </span>
            </h2>
            <div class="section-total">Total: <span id="mfTotal">‚Çπ0</span></div>
            <div id="mfList"></div>
            <div class="last-updated" id="mfLastUpdated"></div>
        </div>

        <!-- RD -->
        <div class="section">
            <h2>
                üîÑ Recurring Deposits
                <button class="add-btn" onclick="showAddRD()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="rdTotal">‚Çπ0</span></div>
            <div id="rdList"></div>
        </div>

        <!-- FD -->
        <div class="section">
            <h2>
                üè¶ Fixed Deposits
                <button class="add-btn" onclick="showAddFD()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="fdTotal">‚Çπ0</span></div>
            <div id="fdList"></div>
        </div>

        <!-- PPF -->
        <div class="section">
            <h2>
                üèõÔ∏è PPF
                <button class="add-btn" onclick="showAddPPF()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="ppfTotal">‚Çπ0</span></div>
            <div id="ppfList"></div>
        </div>

        <!-- DIP Fund -->
        <div class="section">
            <h2>
                üíß DIP Fund
                <button class="add-btn" onclick="showAddDIP()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="dipTotal">‚Çπ0</span></div>
            <div id="dipList"></div>
        </div>

        <!-- Emergency Fund -->
        <div class="section">
            <h2>
                üö® Emergency Fund
                <button class="add-btn" onclick="showAddEmergencyFund()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="emergencyTotal">‚Çπ0</span></div>
            <div id="emergencyList"></div>
        </div>

        <!-- Gold Scheme -->
        <div class="section">
            <h2>
                ü•á Gold Scheme
                <button class="add-btn" onclick="showAddGoldScheme()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="goldTotal">‚Çπ0</span></div>
            <div id="goldList"></div>
        </div>

        <!-- Cash -->
        <div class="section">
            <h2>
                üíµ Cash Savings
                <button class="add-btn" onclick="showAddCash()">+ Add</button>
            </h2>
            <div class="section-total">Total: <span id="cashTotal">‚Çπ0</span></div>
            <div id="cashList"></div>
        </div>
    </div>

    <!-- Custom Categories -->
    <div id="customCategoriesContainer"></div>

    <!-- Add Custom Category Button -->
    <button class="custom-btn" onclick="showAddCustomCategory()">
        ‚ûï Add New Custom Category
    </button>
</div>

<!-- Universal Modal -->
<div id="formModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Add Item</h2>
            <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <div id="modalBody"></div>
    </div>
</div>

<script>
    let portfolio = {
        targetAmount: 0,
        stocks: [],
        mutualFunds: [],
        recurringDeposits: [],
        fixedDeposits: [],
        ppf: [],
        dipFund: [],
        emergencyFund: [],
        goldScheme: [],
        cashSavings: [],
        customCategories: []
    };

    let currentAction = null;

    function loadData() {
        try {
            const saved = localStorage.getItem('portfolioData');
            if (saved) {
                portfolio = JSON.parse(saved);
            }
            document.getElementById('targetAmount').value = portfolio.targetAmount || '';
            updateAllDisplays();
        } catch (e) {
            console.error('Error loading data:', e);
        }
    }

    function saveData() {
        try {
            localStorage.setItem('portfolioData', JSON.stringify(portfolio));
            updateAllDisplays();
        } catch (e) {
            console.error('Error saving data:', e);
        }
    }

    function saveTargetAmount() {
        try {
            const input = document.getElementById('targetAmount');
            const target = parseFloat(input.value) || 0;
            portfolio.targetAmount = target;
            saveData();
            showToast('Goal set successfully! üéØ');
        } catch (e) {
            console.error('Error setting goal:', e);
            showToast('Error setting goal');
        }
    }

    function showToast(message) {
        const toast = document.createElement('div');
        toast.style.cssText = 'position:fixed;top:20px;right:20px;background:#27ae60;color:white;padding:15px 25px;border-radius:8px;z-index:10000;box-shadow:0 5px 15px rgba(0,0,0,0.3);';
        toast.textContent = message;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
    }

    function showModal(title, formHtml, onSave) {
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalBody').innerHTML = formHtml;
        document.getElementById('formModal').style.display = 'block';
        currentAction = onSave;
    }

    function closeModal() {
        document.getElementById('formModal').style.display = 'none';
        currentAction = null;
    }

    function submitForm() {
        if (currentAction) {
            currentAction();
        }
    }

    // [Previous add/display functions remain the same - Stock, MF, RD, FD, PPF, DIP, Emergency, Gold, Cash, Custom]
    // I'll include the complete working versions from the previous file
    
    function showAddStock() {
        const form = `
            <div class="form-group">
                <label>Stock Symbol (e.g., RELIANCE, TCS)</label>
                <input type="text" id="stockSymbol" required>
            </div>
            <div class="form-group">
                <label>Quantity</label>
                <input type="number" id="stockQuantity" required>
            </div>
            <div class="form-group">
                <label>Buy Price (‚Çπ)</label>
                <input type="number" id="stockBuyPrice" step="0.01" required>
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add Stock</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Stock', form, addStock);
    }

    function addStock() {
        const symbol = document.getElementById('stockSymbol').value.toUpperCase();
        const quantity = parseFloat(document.getElementById('stockQuantity').value);
        const buyPrice = parseFloat(document.getElementById('stockBuyPrice').value);

        if (!symbol || !quantity || !buyPrice) {
            showToast('Please fill all fields');
            return;
        }

        portfolio.stocks.push({
            symbol, quantity, buyPrice,
            currentPrice: buyPrice
        });
        saveData();
        closeModal();
        showToast('Stock added! üìà');
    }

    function showAddMF() {
        const form = `
            <div class="form-group">
                <label>Mutual Fund Name</label>
                <input type="text" id="mfName" required>
            </div>
            <div class="form-group">
                <label>Units</label>
                <input type="number" id="mfUnits" step="0.001" required>
            </div>
            <div class="form-group">
                <label>Buy NAV (‚Çπ)</label>
                <input type="number" id="mfBuyNAV" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Scheme Code (optional)</label>
                <input type="text" id="mfSchemeCode">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add MF</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Mutual Fund', form, addMF);
    }

    function addMF() {
        const name = document.getElementById('mfName').value;
        const units = parseFloat(document.getElementById('mfUnits').value);
        const buyNAV = parseFloat(document.getElementById('mfBuyNAV').value);
        const schemeCode = document.getElementById('mfSchemeCode').value;

        if (!name || !units || !buyNAV) {
            showToast('Please fill required fields');
            return;
        }

        portfolio.mutualFunds.push({
            name, units, buyNAV, schemeCode,
            currentNAV: buyNAV
        });
        saveData();
        closeModal();
        showToast('Mutual Fund added! üìä');
    }

    function showAddRD() {
        const form = `
            <div class="form-group">
                <label>Bank Name</label>
                <input type="text" id="rdBank" required>
            </div>
            <div class="form-group">
                <label>Monthly Amount (‚Çπ)</label>
                <input type="number" id="rdAmount" required>
            </div>
            <div class="form-group">
                <label>Interest Rate (% p.a.)</label>
                <input type="number" id="rdRate" step="0.1" required>
            </div>
            <div class="form-group">
                <label>Tenure (months)</label>
                <input type="number" id="rdTenure" required>
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="date" id="rdStartDate" value="2026-01-01" required>
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add RD</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Recurring Deposit', form, addRD);
    }

    function addRD() {
        const bankName = document.getElementById('rdBank').value;
        const monthlyAmount = parseFloat(document.getElementById('rdAmount').value);
        const interestRate = parseFloat(document.getElementById('rdRate').value);
        const tenureMonths = parseInt(document.getElementById('rdTenure').value);
        const startDate = document.getElementById('rdStartDate').value;

        if (!bankName || !monthlyAmount || !interestRate || !tenureMonths || !startDate) {
            showToast('Please fill all fields');
            return;
        }

        portfolio.recurringDeposits.push({
            bankName, monthlyAmount, interestRate, tenureMonths, startDate
        });
        saveData();
        closeModal();
        showToast('RD added! üîÑ');
    }

    function showAddFD() {
        const form = `
            <div class="form-group">
                <label>Bank Name</label>
                <input type="text" id="fdBank" required>
            </div>
            <div class="form-group">
                <label>Principal Amount (‚Çπ)</label>
                <input type="number" id="fdPrincipal" required>
            </div>
            <div class="form-group">
                <label>Interest Rate (% p.a.)</label>
                <input type="number" id="fdRate" step="0.1" required>
            </div>
            <div class="form-group">
                <label>Tenure (months)</label>
                <input type="number" id="fdTenure" required>
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="date" id="fdStartDate" value="2026-01-01" required>
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add FD</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Fixed Deposit', form, addFD);
    }

    function addFD() {
        const bankName = document.getElementById('fdBank').value;
        const principal = parseFloat(document.getElementById('fdPrincipal').value);
        const interestRate = parseFloat(document.getElementById('fdRate').value);
        const tenureMonths = parseInt(document.getElementById('fdTenure').value);
        const startDate = document.getElementById('fdStartDate').value;

        if (!bankName || !principal || !interestRate || !tenureMonths || !startDate) {
            showToast('Please fill all fields');
            return;
        }

        const maturityDate = new Date(startDate);
        maturityDate.setMonth(maturityDate.getMonth() + tenureMonths);

        portfolio.fixedDeposits.push({
            bankName, principal, interestRate, tenureMonths, startDate,
            maturityDate: maturityDate.toISOString().split('T')[0]
        });
        saveData();
        closeModal();
        showToast('FD added! üè¶');
    }

    function showAddPPF() {
        const form = `
            <div class="form-group">
                <label>Annual Contribution (‚Çπ)</label>
                <input type="number" id="ppfAnnual" required>
            </div>
            <div class="form-group">
                <label>Interest Rate (% p.a.)</label>
                <input type="number" id="ppfRate" value="7.1" step="0.1" required>
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="date" id="ppfStartDate" value="2026-01-01" required>
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add PPF</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add PPF Account', form, addPPF);
    }

    function addPPF() {
        const annualContribution = parseFloat(document.getElementById('ppfAnnual').value);
        const interestRate = parseFloat(document.getElementById('ppfRate').value);
        const startDate = document.getElementById('ppfStartDate').value;

        if (!annualContribution || !interestRate || !startDate) {
            showToast('Please fill all fields');
            return;
        }

        const maturityDate = new Date(startDate);
        maturityDate.setFullYear(maturityDate.getFullYear() + 15);

        portfolio.ppf.push({
            annualContribution, interestRate, startDate,
            maturityDate: maturityDate.toISOString().split('T')[0]
        });
        saveData();
        closeModal();
        showToast('PPF added! üèõÔ∏è');
    }

    function showAddDIP() {
        const form = `
            <div class="form-group">
                <label>Fund Name</label>
                <input type="text" id="dipName" required>
            </div>
            <div class="form-group">
                <label>Amount (‚Çπ)</label>
                <input type="number" id="dipAmount" required>
            </div>
            <div class="form-group">
                <label>Bank/Account</label>
                <input type="text" id="dipBank">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add DIP Fund</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add DIP Fund', form, addDIP);
    }

    function addDIP() {
        const name = document.getElementById('dipName').value;
        const amount = parseFloat(document.getElementById('dipAmount').value);
        const bank = document.getElementById('dipBank').value || 'N/A';

        if (!name || isNaN(amount)) {
            showToast('Please fill required fields');
            return;
        }

        portfolio.dipFund.push({
            name, amount, bank,
            lastUpdated: new Date().toISOString()
        });
        saveData();
        closeModal();
        showToast('DIP Fund added! üíß');
    }

    function showAddEmergencyFund() {
        const form = `
            <div class="form-group">
                <label>Fund Name</label>
                <input type="text" id="efName" required>
            </div>
            <div class="form-group">
                <label>Amount (‚Çπ)</label>
                <input type="number" id="efAmount" required>
            </div>
            <div class="form-group">
                <label>Bank/Account</label>
                <input type="text" id="efBank">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add Emergency Fund</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Emergency Fund', form, addEmergencyFund);
    }

    function addEmergencyFund() {
        const name = document.getElementById('efName').value;
        const amount = parseFloat(document.getElementById('efAmount').value);
        const bank = document.getElementById('efBank').value || 'N/A';

        if (!name || isNaN(amount)) {
            showToast('Please fill required fields');
            return;
        }

        portfolio.emergencyFund.push({
            name, amount, bank,
            lastUpdated: new Date().toISOString()
        });
        saveData();
        closeModal();
        showToast('Emergency Fund added! üö®');
    }

    function showAddGoldScheme() {
        const form = `
            <div class="form-group">
                <label>Scheme Name</label>
                <input type="text" id="goldName" required>
            </div>
            <div class="form-group">
                <label>Current Value (‚Çπ)</label>
                <input type="number" id="goldAmount" required>
            </div>
            <div class="form-group">
                <label>Type (Digital/Physical/ETF)</label>
                <input type="text" id="goldType">
            </div>
            <div class="form-group">
                <label>Grams (if applicable)</label>
                <input type="number" id="goldGrams" step="0.01">
            </div>
            <div class="form-group">
                <label>Scheme/Bank Name</label>
                <input type="text" id="goldScheme">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add Gold Scheme</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Gold Scheme', form, addGoldScheme);
    }

    function addGoldScheme() {
        const name = document.getElementById('goldName').value;
        const amount = parseFloat(document.getElementById('goldAmount').value);
        const type = document.getElementById('goldType').value || 'N/A';
        const grams = document.getElementById('goldGrams').value || 'N/A';
        const scheme = document.getElementById('goldScheme').value || 'N/A';

        if (!name || isNaN(amount)) {
            showToast('Please fill required fields');
            return;
        }

        portfolio.goldScheme.push({
            name, amount, type, grams, scheme,
            lastUpdated: new Date().toISOString()
        });
        saveData();
        closeModal();
        showToast('Gold Scheme added! ü•á');
    }

    function showAddCash() {
        const form = `
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="cashName" required>
            </div>
            <div class="form-group">
                <label>Amount (‚Çπ)</label>
                <input type="number" id="cashAmount" required>
            </div>
            <div class="form-group">
                <label>Location</label>
                <input type="text" id="cashLocation">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add Cash</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Cash Savings', form, addCash);
    }

    function addCash() {
        const name = document.getElementById('cashName').value;
        const amount = parseFloat(document.getElementById('cashAmount').value);
        const location = document.getElementById('cashLocation').value || 'N/A';

        if (!name || isNaN(amount)) {
            showToast('Please fill required fields');
            return;
        }

        portfolio.cashSavings.push({
            name, amount, location,
            lastUpdated: new Date().toISOString()
        });
        saveData();
        closeModal();
        showToast('Cash added! üíµ');
    }

    function showAddCustomCategory() {
        const form = `
            <div class="form-group">
                <label>Category Name</label>
                <input type="text" id="customCatName" placeholder="e.g., Insurance, Bonds" required>
            </div>
            <div class="form-group">
                <label>Emoji Icon</label>
                <input type="text" id="customCatIcon" placeholder="e.g., üõ°Ô∏è, üíé" value="üìÅ">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add Category</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Custom Category', form, addCustomCategory);
    }

    function addCustomCategory() {
        const name = document.getElementById('customCatName').value;
        const icon = document.getElementById('customCatIcon').value || 'üìÅ';

        if (!name) {
            showToast('Please enter category name');
            return;
        }

        portfolio.customCategories.push({
            name, icon, items: []
        });
        saveData();
        closeModal();
        showToast('Custom category added! ‚ûï');
    }

    function showAddCustomItem(catIndex) {
        const form = `
            <div class="form-group">
                <label>Item Name</label>
                <input type="text" id="customItemName" required>
            </div>
            <div class="form-group">
                <label>Amount (‚Çπ)</label>
                <input type="number" id="customItemAmount" required>
            </div>
            <div class="form-group">
                <label>Notes</label>
                <input type="text" id="customItemNotes">
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Add Item</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Add Item', form, () => addCustomItem(catIndex));
    }

    function addCustomItem(catIndex) {
        const name = document.getElementById('customItemName').value;
        const amount = parseFloat(document.getElementById('customItemAmount').value);
        const notes = document.getElementById('customItemNotes').value || '';

        if (!name || isNaN(amount)) {
            showToast('Please fill required fields');
            return;
        }

        portfolio.customCategories[catIndex].items.push({
            name, amount, notes,
            lastUpdated: new Date().toISOString()
        });
        saveData();
        closeModal();
        showToast('Item added!');
    }

    // Calculate functions
    function calculateTotal() {
        let total = 0;
        
        portfolio.stocks.forEach(s => total += (s.currentPrice || s.buyPrice) * s.quantity);
        portfolio.mutualFunds.forEach(m => total += (m.currentNAV || m.buyNAV) * m.units);
        portfolio.recurringDeposits.forEach(r => total += calculateRDValue(r));
        portfolio.fixedDeposits.forEach(f => total += calculateFDValue(f));
        portfolio.ppf.forEach(p => total += calculatePPFValue(p));
        portfolio.dipFund.forEach(d => total += d.amount);
        portfolio.emergencyFund.forEach(e => total += e.amount);
        portfolio.goldScheme.forEach(g => total += g.amount);
        portfolio.cashSavings.forEach(c => total += c.amount);
        portfolio.customCategories.forEach(cat => {
            cat.items.forEach(item => total += item.amount);
        });
        
        return total;
    }

    function calculateRDValue(rd) {
        const monthsElapsed = getMonthsSince(rd.startDate);
        const monthlyAmount = rd.monthlyAmount;
        const rate = rd.interestRate / 100 / 12;
        
        let maturityValue = 0;
        for (let i = 1; i <= Math.min(monthsElapsed, rd.tenureMonths); i++) {
            maturityValue += monthlyAmount * Math.pow(1 + rate, rd.tenureMonths - i + 1);
        }
        
        return maturityValue;
    }

    function calculateFDValue(fd) {
        const monthsElapsed = getMonthsSince(fd.startDate);
        const principal = fd.principal;
        const rate = fd.interestRate / 100;
        const years = Math.min(monthsElapsed, fd.tenureMonths) / 12;
        
        const quarters = years * 4;
        return principal * Math.pow(1 + rate / 4, quarters);
    }

    function calculatePPFValue(ppf) {
        const yearsElapsed = getMonthsSince(ppf.startDate) / 12;
        const annualContribution = ppf.annualContribution;
        const rate = ppf.interestRate / 100;
        
        let value = 0;
        for (let i = 0; i < Math.min(yearsElapsed, 15); i++) {
            value = (value + annualContribution) * (1 + rate);
        }
        
        return value;
    }

    function getMonthsSince(dateString) {
        const start = new Date(dateString);
        const now = new Date();
        return (now.getFullYear() - start.getFullYear()) * 12 + (now.getMonth() - start.getMonth());
    }

    function formatCurrency(amount) {
        return '‚Çπ' + Math.round(amount).toLocaleString('en-IN');
    }

    function updateAllDisplays() {
        const total = calculateTotal();
        const target = portfolio.targetAmount || 0;
        const remaining = Math.max(0, target - total);
        const progress = target > 0 ? (total / target * 100) : 0;
        
        document.getElementById('totalSaved').textContent = formatCurrency(total);
        document.getElementById('targetDisplay').textContent = formatCurrency(target);
        document.getElementById('remaining').textContent = formatCurrency(remaining);
        document.getElementById('progressPercent').textContent = progress.toFixed(1) + '%';
        
        const progressBar = document.getElementById('journeyProgress');
        progressBar.style.width = Math.min(progress, 100) + '%';
        progressBar.textContent = progress.toFixed(1) + '%';
        
        displayStocks();
        displayMutualFunds();
        displayRDs();
        displayFDs();
        displayPPF();
        displayDIP();
        displayEmergencyFund();
        displayGoldScheme();
        displayCash();
        displayCustomCategories();
    }

    function displayStocks() {
        const list = document.getElementById('stockList');
        let html = '';
        let total = 0;
        
        portfolio.stocks.forEach((stock, index) => {
            const currentPrice = stock.currentPrice || stock.buyPrice;
            const currentValue = currentPrice * stock.quantity;
            const invested = stock.buyPrice * stock.quantity;
            const profit = currentValue - invested;
            const profitPercent = (profit / invested * 100).toFixed(2);
            
            total += currentValue;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${stock.symbol}</span>
                        <span class="item-value">${formatCurrency(currentValue)}</span>
                    </div>
                    <div class="item-details">
                        <div>Qty: ${stock.quantity}</div>
                        <div>Buy: ${formatCurrency(stock.buyPrice)}</div>
                        <div>Current: ${formatCurrency(currentPrice)}</div>
                        <div class="${profit >= 0 ? 'profit-positive' : 'profit-negative'}">
                            P&L: ${formatCurrency(profit)} (${profitPercent}%)
                        </div>
                    </div>
                    ${stock.lastPriceUpdate ? `<div style="font-size: 11px; color: #999; margin-top: 5px;">Updated: ${new Date(stock.lastPriceUpdate).toLocaleString()}</div>` : ''}
                    <button class="btn btn-delete" onclick="updateStockPrice(${index})" style="background: #3498db; margin-right: 5px;">Update Price</button>
                    <button class="btn btn-delete" onclick="deleteItem('stocks', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No stocks added yet</p>';
        document.getElementById('stockTotal').textContent = formatCurrency(total);
    }

    function updateStockPrice(index) {
        const stock = portfolio.stocks[index];
        const form = `
            <div class="form-group">
                <label>Stock: ${stock.symbol}</label>
                <p style="color: #666; font-size: 14px;">Current Price: ${formatCurrency(stock.currentPrice || stock.buyPrice)}</p>
            </div>
            <div class="form-group">
                <label>New Current Price (‚Çπ)</label>
                <input type="number" id="newStockPrice" step="0.01" value="${stock.currentPrice || stock.buyPrice}" required>
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Update</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Update Stock Price', form, () => {
            const newPrice = parseFloat(document.getElementById('newStockPrice').value);
            if (newPrice && newPrice > 0) {
                portfolio.stocks[index].currentPrice = newPrice;
                portfolio.stocks[index].lastPriceUpdate = new Date().toISOString();
                saveData();
                closeModal();
                showToast('Stock price updated! üìà');
            } else {
                showToast('Please enter a valid price');
            }
        });
    }

    function displayMutualFunds() {
        const list = document.getElementById('mfList');
        let html = '';
        let total = 0;
        
        portfolio.mutualFunds.forEach((mf, index) => {
            const currentNAV = mf.currentNAV || mf.buyNAV;
            const currentValue = currentNAV * mf.units;
            const invested = mf.buyNAV * mf.units;
            const profit = currentValue - invested;
            const profitPercent = (profit / invested * 100).toFixed(2);
            
            total += currentValue;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${mf.name}</span>
                        <span class="item-value">${formatCurrency(currentValue)}</span>
                    </div>
                    <div class="item-details">
                        <div>Units: ${mf.units.toFixed(3)}</div>
                        <div>Buy NAV: ${formatCurrency(mf.buyNAV)}</div>
                        <div>Current NAV: ${formatCurrency(currentNAV)}</div>
                        <div class="${profit >= 0 ? 'profit-positive' : 'profit-negative'}">
                            P&L: ${formatCurrency(profit)} (${profitPercent}%)
                        </div>
                    </div>
                    ${mf.lastNAVUpdate ? `<div style="font-size: 11px; color: #999; margin-top: 5px;">Updated: ${new Date(mf.lastNAVUpdate).toLocaleString()}</div>` : ''}
                    <button class="btn btn-delete" onclick="updateMFNAV(${index})" style="background: #3498db; margin-right: 5px;">Update NAV</button>
                    <button class="btn btn-delete" onclick="deleteItem('mutualFunds', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No mutual funds added yet</p>';
        document.getElementById('mfTotal').textContent = formatCurrency(total);
    }

    function updateMFNAV(index) {
        const mf = portfolio.mutualFunds[index];
        const form = `
            <div class="form-group">
                <label>Fund: ${mf.name}</label>
                <p style="color: #666; font-size: 14px;">Current NAV: ${formatCurrency(mf.currentNAV || mf.buyNAV)}</p>
            </div>
            <div class="form-group">
                <label>New NAV (‚Çπ)</label>
                <input type="number" id="newMFNAV" step="0.0001" value="${mf.currentNAV || mf.buyNAV}" required>
            </div>
            <div class="form-actions">
                <button class="btn btn-save" onclick="submitForm()">Update</button>
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
            </div>
        `;
        showModal('Update MF NAV', form, () => {
            const newNAV = parseFloat(document.getElementById('newMFNAV').value);
            if (newNAV && newNAV > 0) {
                portfolio.mutualFunds[index].currentNAV = newNAV;
                portfolio.mutualFunds[index].lastNAVUpdate = new Date().toISOString();
                saveData();
                closeModal();
                showToast('MF NAV updated! üìä');
            } else {
                showToast('Please enter a valid NAV');
            }
        });
    }

    // Display functions for RD, FD, PPF, DIP, Emergency, Gold, Cash (same as before)
    function displayRDs() {
        const list = document.getElementById('rdList');
        let html = '';
        let total = 0;
        
        portfolio.recurringDeposits.forEach((rd, index) => {
            const currentValue = calculateRDValue(rd);
            const monthsElapsed = Math.min(getMonthsSince(rd.startDate), rd.tenureMonths);
            const invested = rd.monthlyAmount * monthsElapsed;
            
            total += currentValue;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${rd.bankName}</span>
                        <span class="item-value">${formatCurrency(currentValue)}</span>
                    </div>
                    <div class="item-details">
                        <div>Monthly: ${formatCurrency(rd.monthlyAmount)}</div>
                        <div>Rate: ${rd.interestRate}%</div>
                        <div>Months: ${monthsElapsed}/${rd.tenureMonths}</div>
                        <div>Invested: ${formatCurrency(invested)}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('recurringDeposits', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No RDs added yet</p>';
        document.getElementById('rdTotal').textContent = formatCurrency(total);
    }

    function displayFDs() {
        const list = document.getElementById('fdList');
        let html = '';
        let total = 0;
        
        portfolio.fixedDeposits.forEach((fd, index) => {
            const currentValue = calculateFDValue(fd);
            const monthsElapsed = Math.min(getMonthsSince(fd.startDate), fd.tenureMonths);
            
            total += currentValue;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${fd.bankName}</span>
                        <span class="item-value">${formatCurrency(currentValue)}</span>
                    </div>
                    <div class="item-details">
                        <div>Principal: ${formatCurrency(fd.principal)}</div>
                        <div>Rate: ${fd.interestRate}%</div>
                        <div>Months: ${monthsElapsed}/${fd.tenureMonths}</div>
                        <div>Maturity: ${new Date(fd.maturityDate).toLocaleDateString()}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('fixedDeposits', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No FDs added yet</p>';
        document.getElementById('fdTotal').textContent = formatCurrency(total);
    }

    function displayPPF() {
        const list = document.getElementById('ppfList');
        let html = '';
        let total = 0;
        
        portfolio.ppf.forEach((ppf, index) => {
            const currentValue = calculatePPFValue(ppf);
            const yearsElapsed = (getMonthsSince(ppf.startDate) / 12).toFixed(1);
            
            total += currentValue;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">PPF Account</span>
                        <span class="item-value">${formatCurrency(currentValue)}</span>
                    </div>
                    <div class="item-details">
                        <div>Annual: ${formatCurrency(ppf.annualContribution)}</div>
                        <div>Rate: ${ppf.interestRate}%</div>
                        <div>Years: ${yearsElapsed}/15</div>
                        <div>Maturity: ${new Date(ppf.maturityDate).toLocaleDateString()}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('ppf', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No PPF accounts added yet</p>';
        document.getElementById('ppfTotal').textContent = formatCurrency(total);
    }

    function displayDIP() {
        const list = document.getElementById('dipList');
        let html = '';
        let total = 0;
        
        portfolio.dipFund.forEach((dip, index) => {
            total += dip.amount;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${dip.name}</span>
                        <span class="item-value">${formatCurrency(dip.amount)}</span>
                    </div>
                    <div class="item-details">
                        <div>Bank: ${dip.bank}</div>
                        <div>Updated: ${new Date(dip.lastUpdated).toLocaleDateString()}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('dipFund', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No DIP fund added yet</p>';
        document.getElementById('dipTotal').textContent = formatCurrency(total);
    }

    function displayEmergencyFund() {
        const list = document.getElementById('emergencyList');
        let html = '';
        let total = 0;
        
        portfolio.emergencyFund.forEach((ef, index) => {
            total += ef.amount;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${ef.name}</span>
                        <span class="item-value">${formatCurrency(ef.amount)}</span>
                    </div>
                    <div class="item-details">
                        <div>Bank: ${ef.bank}</div>
                        <div>Updated: ${new Date(ef.lastUpdated).toLocaleDateString()}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('emergencyFund', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No emergency fund added yet</p>';
        document.getElementById('emergencyTotal').textContent = formatCurrency(total);
    }

    function displayGoldScheme() {
        const list = document.getElementById('goldList');
        let html = '';
        let total = 0;
        
        portfolio.goldScheme.forEach((gold, index) => {
            total += gold.amount;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${gold.name}</span>
                        <span class="item-value">${formatCurrency(gold.amount)}</span>
                    </div>
                    <div class="item-details">
                        <div>Type: ${gold.type}</div>
                        <div>Grams: ${gold.grams}</div>
                        <div>Scheme: ${gold.scheme}</div>
                        <div>Updated: ${new Date(gold.lastUpdated).toLocaleDateString()}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('goldScheme', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No gold scheme added yet</p>';
        document.getElementById('goldTotal').textContent = formatCurrency(total);
    }

    function displayCash() {
        const list = document.getElementById('cashList');
        let html = '';
        let total = 0;
        
        portfolio.cashSavings.forEach((cash, index) => {
            total += cash.amount;
            
            html += `
                <div class="item">
                    <div class="item-header">
                        <span class="item-name">${cash.name}</span>
                        <span class="item-value">${formatCurrency(cash.amount)}</span>
                    </div>
                    <div class="item-details">
                        <div>Location: ${cash.location}</div>
                        <div>Updated: ${new Date(cash.lastUpdated).toLocaleDateString()}</div>
                    </div>
                    <button class="btn btn-delete" onclick="deleteItem('cashSavings', ${index})">Delete</button>
                </div>
            `;
        });
        
        list.innerHTML = html || '<p class="loading">No cash savings added yet</p>';
        document.getElementById('cashTotal').textContent = formatCurrency(total);
    }

    function displayCustomCategories() {
        const container = document.getElementById('customCategoriesContainer');
        let html = '';
        
        portfolio.customCategories.forEach((category, catIndex) => {
            let catTotal = 0;
            let itemsHtml = '';
            
            category.items.forEach((item, itemIndex) => {
                catTotal += item.amount;
                
                itemsHtml += `
                    <div class="item">
                        <div class="item-header">
                            <span class="item-name">${item.name}</span>
                            <span class="item-value">${formatCurrency(item.amount)}</span>
                        </div>
                        <div class="item-details">
                            <div>Notes: ${item.notes || 'N/A'}</div>
                            <div>Updated: ${new Date(item.lastUpdated).toLocaleDateString()}</div>
                        </div>
                        <button class="btn btn-delete" onclick="deleteCustomItem(${catIndex}, ${itemIndex})">Delete</button>
                    </div>
                `;
            });
            
            html += `
                <div class="portfolio-grid" style="margin-top: 20px;">
                    <div class="section">
                        <h2>
                            ${category.icon} ${category.name}
                            <span>
                                <button class="add-btn" onclick="showAddCustomItem(${catIndex})">+ Add</button>
                                <button class="btn btn-delete" onclick="deleteItem('customCategories', ${catIndex})">Delete Category</button>
                            </span>
                        </h2>
                        <div class="section-total">Total: ${formatCurrency(catTotal)}</div>
                        <div>${itemsHtml || '<p class="loading">No items added yet</p>'}</div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }

    function deleteItem(category, index) {
        if (confirm('Delete this item?')) {
            portfolio[category].splice(index, 1);
            saveData();
            showToast('Item deleted');
        }
    }

    function deleteCustomItem(catIndex, itemIndex) {
        if (confirm('Delete this item?')) {
            portfolio.customCategories[catIndex].items.splice(itemIndex, 1);
            saveData();
            showToast('Item deleted');
        }
    }

    // AUTO-REFRESH FUNCTIONS (Will work when hosted externally)
    async function refreshStockPrices() {
        if (portfolio.stocks.length === 0) {
            showToast('No stocks added yet!');
            return;
        }
        
        showToast('Updating stock prices...');
        document.getElementById('stockLastUpdated').textContent = 'Refreshing...';
        
        let updated = 0;
        let failed = 0;
        
        for (let stock of portfolio.stocks) {
            try {
                const symbol = stock.symbol + '.NS';
                const response = await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?interval=1d&range=1d`);
                const data = await response.json();
                
                if (data.chart?.result?.[0]?.meta?.regularMarketPrice) {
                    stock.currentPrice = data.chart.result[0].meta.regularMarketPrice;
                    stock.lastPriceUpdate = new Date().toISOString();
                    updated++;
                } else {
                    failed++;
                }
            } catch (error) {
                console.error(`Error fetching ${stock.symbol}:`, error);
                failed++;
            }
            await new Promise(resolve => setTimeout(resolve, 500));
        }
        
        saveData();
        document.getElementById('stockLastUpdated').textContent = 
            `Last updated: ${new Date().toLocaleTimeString()} | Success: ${updated}, Failed: ${failed}`;
        
        if (updated > 0) {
            showToast(`Updated ${updated} stock prices! üìà`);
        } else {
            showToast('Auto-refresh failed. Use manual update instead.');
        }
    }

    async function refreshMFPrices() {
        if (portfolio.mutualFunds.length === 0) {
            showToast('No mutual funds added yet!');
            return;
        }
        
        showToast('Updating NAV...');
        document.getElementById('mfLastUpdated').textContent = 'Refreshing...';
        
        let updated = 0;
        let failed = 0;
        
        for (let mf of portfolio.mutualFunds) {
            try {
                if (mf.schemeCode) {
                    const response = await fetch(`https://api.mfapi.in/mf/${mf.schemeCode}/latest`);
                    const data = await response.json();
                    
                    if (data?.data?.[0]) {
                        mf.currentNAV = parseFloat(data.data[0].nav);
                        mf.lastNAVUpdate = new Date().toISOString();
                        updated++;
                    } else {
                        failed++;
                    }
                } else {
                    failed++;
                }
            } catch (error) {
                console.error(`Error fetching NAV for ${mf.name}:`, error);
                failed++;
            }
            await new Promise(resolve => setTimeout(resolve, 300));
        }
        
        saveData();
        document.getElementById('mfLastUpdated').textContent = 
            `Last updated: ${new Date().toLocaleTimeString()} | Success: ${updated}, Failed: ${failed}`;
        
        if (updated > 0) {
            showToast(`Updated ${updated} mutual fund NAVs! üìä`);
        } else {
            showToast('Auto-refresh failed. Add scheme codes or use manual update.');
        }
    }

    window.onclick = function(event) {
        const modal = document.getElementById('formModal');
        if (event.target == modal) {
            closeModal();
        }
    }

    window.onload = loadData;
</script>
```

</body>
</html>
